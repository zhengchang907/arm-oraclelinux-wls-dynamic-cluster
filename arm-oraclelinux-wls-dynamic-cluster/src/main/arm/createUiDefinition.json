{
    "$schema": "https://schema.management.azure.com/schemas/0.1.2-preview/CreateUIDefinition.MultiVm.json#",
    "handler": "Microsoft.Azure.CreateUIDef",
    "version": "0.1.2-preview",
    "parameters": {
        "basics": [
            {
                "name": "skuUrnVersion",
                "type": "Microsoft.Common.DropDown",
                "label": "Oracle WebLogic Image",
                "defaultValue": "WebLogic Server 14.1.1.0.0 and JDK11 on Oracle Linux 7.6",
                "toolTip": "Choose Oracle WebLogic image, which is provided by Oracle, with Java and WebLogic preinstalled.",
                "constraints": {
                    "allowedValues": [
                        {
                            "label": "WebLogic Server 12.2.1.3.0 and JDK8 on Oracle Linux 7.4",
                            "value": "owls-122130-jdk8-ol74;Oracle:weblogic-122130-jdk8-ol74:owls-122130-jdk8-ol7;latest"
                        },
                        {
                            "label": "WebLogic Server 12.2.1.3.0 and JDK8 on Oracle Linux 7.3",
                            "value": "owls-122130-jdk8-ol73;Oracle:weblogic-122130-jdk8-ol73:owls-122130-jdk8-ol7;latest"
                        },
                        {
                            "label": "WebLogic Server 12.2.1.4.0 and JDK8 on Oracle Linux 7.6",
                            "value": "owls-122140-jdk8-ol76;Oracle:weblogic-122140-jdk8-ol76:owls-122140-jdk8-ol7;latest"
                        },
                        {
                            "label": "WebLogic Server 14.1.1.0.0 and JDK8 on Oracle Linux 7.6",
                            "value": "owls-141100-jdk8-ol76;Oracle:weblogic-141100-jdk8-ol76:owls-141100-jdk8-ol7;latest"
                        },
                        {
                            "label": "WebLogic Server 14.1.1.0.0 and JDK11 on Oracle Linux 7.6",
                            "value": "owls-141100-jdk11-ol76;Oracle:weblogic-141100-jdk11-ol76:owls-141100-jdk11-ol7;latest"
                        }
                    ],
                    "required": true
                },
                "visible": true
            },
            {
                "name": "vmSizeSelect",
                "type": "Microsoft.Compute.SizeSelector",
                "label": "Virtual machine size",
                "toolTip": "The size of virtual machine to provision.",
                "recommendedSizes": [
                    "Standard_A1",
                    "Standard_A2",
                    "Standard_A3",
                    "Standard_A4",
                    "Standard_B1ms"
                ],
                "constraints": {
                    "excludedSizes": [
                        "Standard_B1ls",
                        "Standard_A0",
                        "Basic_A0",
                        "Standard_B1s"
                    ]
                },
                "osPlatform": "Linux",
                "count": "1",
                "visible": true
            },
            {
                "name": "basicsRequired",
                "type": "Microsoft.Common.Section",
                "label": "Credentials for Virtual Machines and WebLogic",
                "elements": [
                    {
                        "name": "adminUsername",
                        "type": "Microsoft.Common.TextBox",
                        "label": "Username for admin account of VMs",
                        "defaultValue": "weblogic",
                        "toolTip": "Use only letters and numbers",
                        "constraints": {
                            "required": true,
                            "regex": "^[a-z0-9A-Z]{1,30}$",
                            "validationMessage": "The value must be 1-30 characters long and must only contain letters and numbers."
                        },
                        "visible": true
                    },
                    {
                        "name": "adminPasswordOrKey",
                        "type": "Microsoft.Compute.CredentialsCombo",
                        "label": {
                            "authenticationType": "Authentication type",
                            "password": "Password",
                            "confirmPassword": "Confirm password",
                            "sshPublicKey": "SSH public key"
                        },
                        "toolTip": {
                            "authenticationType": "Use username and password or SSH public key for authentication to the VM",
                            "password": "Password for admin account of VMs",
                            "sshPublicKey": "SSH key for admin account of VMs"
                        },
                        "constraints": {
                            "required": true,
                            "customPasswordRegex": "^((?=.*[0-9])(?=.*[a-z])(?=.*[A-Z])|(?=.*[0-9])(?=.*[a-z])(?=.*[!@#$%^&*])|(?=.*[0-9])(?=.*[A-Z])(?=.*[!@#$%^&*])|(?=.*[a-z])(?=.*[A-Z])(?=.*[!@#$%^&*])).{12,72}$",
                            "customValidationMessage": "Password must be at least 12 characters long and have 3 out of the following: one number, one lower case, one upper case, or one special character"
                        },
                        "options": {
                            "hideConfirmation": false,
                            "hidePassword": false
                        },
                        "osPlatform": "Linux",
                        "visible": true
                    },
                    {
                        "name": "wlsUserName",
                        "type": "Microsoft.Common.TextBox",
                        "label": "Username for WebLogic Administrator",
                        "defaultValue": "weblogic",
                        "toolTip": "Use only letters and numbers",
                        "constraints": {
                            "required": true,
                            "regex": "^[a-z0-9A-Z]{1,30}$",
                            "validationMessage": "The value must be 1-30 characters long and must only contain letters and numbers."
                        },
                        "visible": true
                    },
                    {
                        "name": "wlsPassword",
                        "type": "Microsoft.Common.PasswordBox",
                        "label": {
                            "password": "Password for WebLogic Administrator",
                            "confirmPassword": "Confirm password"
                        },
                        "toolTip": "Password for WebLogic Administrator",
                        "constraints": {
                            "required": true,
                            "regex": "^(?=.*[A-Z])(?=.*[a-z])(?=.*\\d)[A-Za-z\\d]{12,}$",
                            "validationMessage": "The password must contain at least 12 characters, with at least 1 uppercase letter, 1 lowercase letter and 1 number, and special characters are not allowed."
                        },
                        "options": {
                            "hideConfirmation": false
                        },
                        "visible": true
                    },
                    {
                        "name": "dynamicClusterSize",
                        "type": "Microsoft.Common.TextBox",
                        "label": "Initial Dynamic Cluster Size",
                        "defaultValue": "3",
                        "toolTip": "Initial Number of Managed Servers that will be configured in the Dynamic Cluster",
                        "constraints": {
                            "required": true,
                            "regex": "^(2|3|4|5|6|7|8|9|10){1,2}$",
                            "validationMessage": "Initial Number of Managed Servers that will be configured in the Dynamic Cluster"
                        },
                        "visible": true
                    },
                    {
                        "name": "maxDynamicClusterSize",
                        "type": "Microsoft.Common.TextBox",
                        "label": "Maximum Dynamic Cluster Size",
                        "defaultValue": "8",
                        "toolTip": "Maximum Number of Managed Servers allowed to be configured in the Dynamic Cluster",
                        "constraints": {
                            "required": true,
                            "regex": "^(2|3|4|5|6|7|8|9|10){1,2}$",
                            "validationMessage": "Maximum Number of Managed Servers allowed to be configured in the Dynamic Cluster"
                        },
                        "visible": true
                    }
                ],
                "visible": true
            },
            {
                "name": "basicsOptional",
                "type": "Microsoft.Common.Section",
                "label": "Optional Basic Configuration",
                "elements": [
                    {
                        "name": "basicsOptionalAcceptDefaults",
                        "type": "Microsoft.Common.OptionsGroup",
                        "label": "Accept defaults for optional configuration?",
                        "defaultValue": "Yes",
                        "toolTip": "Select 'No' to edit optional basic configuration.",
                        "constraints": {
                            "allowedValues": [
                                {
                                    "label": "Yes",
                                    "value": "false"
                                },
                                {
                                    "label": "No",
                                    "value": "true"
                                }
                            ],
                            "required": true
                        }
                    },
                    {
                        "name": "dnsLabelPrefix",
                        "type": "Microsoft.Common.TextBox",
                        "label": "DNS Label Prefix",
                        "toolTip": "The string to prepend to the DNS label.",
                        "defaultValue": "wls",
                        "constraints": {
                            "required": true,
                            "regex": "^[a-z0-9A-Z]{3,10}$",
                            "validationMessage": "The prefix must be between 3 and 10 characters long and contain letters, numbers only."
                        },
                        "visible": "[bool(basics('basicsOptional').basicsOptionalAcceptDefaults)]"
                    },
                    {
                        "name": "managedServerPrefix",
                        "type": "Microsoft.Common.TextBox",
                        "label": "Managed Server Prefix",
                        "toolTip": "The string to prepend to the name of the managed server.  Must start with letters and not have a run of more than eight digits.",
                        "defaultValue": "msp",
                        "constraints": {
                            "required": true,
                            "regex": "^[a-z0-9A-Z]{3,20}$",
                            "validationMessage": "The prefix must be between 3 and 20 characters long and contain letters, numbers only."
                        },
                        "visible": "[bool(basics('basicsOptional').basicsOptionalAcceptDefaults)]"
                    },
                    {
                        "name": "wlsDomainName",
                        "type": "Microsoft.Common.TextBox",
                        "label": "WebLogic Domain Name",
                        "toolTip": "The name of the WebLogic Domain to create.",
                        "defaultValue": "clusterDomain",
                        "constraints": {
                            "required": true,
                            "regex": "^[a-z0-9A-Z]{3,20}$",
                            "validationMessage": "The Domain Name must be between 3 and 20 characters long and contain letters, numbers only."
                        },
                        "visible": "[bool(basics('basicsOptional').basicsOptionalAcceptDefaults)]"
                    },
                    {
                        "name": "portsToExpose",
                        "label": "Ports and port ranges to expose (N or N-N, comma separated)",
                        "type": "Microsoft.Common.TextBox",
                        "toolTip": "Ports and port ranges to expose (N or N-N, comma separated)",
                        "defaultValue": "80,443,7001-9000",
                        "constraints": {
                            "required": true,
                            "regex": "^(((([0-9]+-[0-9]+)|([0-9]+))[,]?)+[^,]){1,1000}$",
                            "validationMessage": "Only numbers, hyphen separated ranges of numbers, separated by commas"
                        },
                        "visible": "[bool(basics('basicsOptional').basicsOptionalAcceptDefaults)]"
                    }
                ],
                "visible": true
            },
            {
                "name": "useSystemAssignedManagedIdentity",
                "label": "Cause a system assigned managed identity to be created for the VM(s).",
                "type": "Microsoft.Common.OptionsGroup",
                "toolTip": "System assigned managed identities enable credential-free secure access to many Azure resources from this VM.",
                "constraints": {
                    "allowedValues": [
                        {
                            "label": "Yes",
                            "value": true
                        },
                        {
                            "label": "No",
                            "value": false
                        }
                    ],
                    "required": true
                },
                "defaultValue": "Yes",
                "visible": "[bool(basics('basicsOptional').basicsOptionalAcceptDefaults)]"
            }, 
            {
                "name": "About",
                "type": "Microsoft.Common.InfoBox",
                "options": {
                    "icon": "None",
                    "text": "Template version ${project.version}"
                },
                "visible": "[bool('true')]"
            }
        ],
        "steps": [
            {
                "name": "section_ohs",
                "type": "Microsoft.Common.Section",
                "label": "Oracle HTTP Server Load Balancer",
                "elements": [
                    {
                        "name": "connectToOHSext",
                        "type": "Microsoft.Common.TextBlock",
                        "visible": true,
                        "options": {
                            "text": "Selecting 'Yes' here will cause the template to provision an Azure Oracle HTTP Server, setup a public IP, and configuration with WebLogic cluster address.  Further configuration may be necessary after deployment.",
                            "link": {
                                "label": "Learn more",
                                "uri": "https://docs.oracle.com/en/middleware/fusion-middleware/web-tier/12.2.1.4/index.html"
                            }
                        }
                    },
                    {
                        "name": "enableOHS",
                        "type": "Microsoft.Common.OptionsGroup",
                        "label": "Connect to Oracle HTTP Server?",
                        "defaultValue": "No",
                        "toolTip": "Select 'Yes' to cause an Azure Oracle HTTP Server to be created as the load balancer for the cluster.",
                        "constraints": {
                            "allowedValues": [
                                {
                                    "label": "Yes",
                                    "value": true
                                },
                                {
                                    "label": "No",
                                    "value": false
                                }
                            ],
                            "required": false
                        }
                    },
                    {
                        "name": "keyVaultText",
                        "type": "Microsoft.Common.TextBlock",
                        "visible": "[steps('section_ohs').enableOHS]",
                        "options": {
                            "text": "Oracle HTTP Server integration requires an SSL Certificate to enable SSL termination. End-to-end SSL encryption is not supported by the template.  The template will look for the certificate and its password in the Azure KeyVault specified here.",
                            "link": {
                                "label": "Learn more",
                                "uri": "https://aka.ms/arm-oraclelinux-wls-dynamic-cluster-ohs"
                            }
                        }
                    },
                    {
                        "name": "ohsSkuUrnVersion",
                        "type": "Microsoft.Common.DropDown",
                        "label": "Oracle HTTP Server image",
                        "defaultValue": "OHS Server 12.2.1.4.0 and JDK8 on Oracle Linux 7.6",
                        "toolTip": "Choose Oracle HTTP Server image, which is provided by Oracle, with Java and HTTP Server preinstalled.",
                        "constraints": {
                            "allowedValues": [
                                {
                                    "label": "OHS Server 12.2.1.4.0 and JDK8 on Oracle Linux 7.3",
                                    "value": "wls-base-image-test1-preview;test-ohs-122140-jdk8-ol73;latest"
                                },
                                {
                                    "label": "OHS Server 12.2.1.4.0 and JDK8 on Oracle Linux 7.4",
                                    "value": "wls-base-image-test1-preview;test-ohs-122140-jdk8-ol74;latest"
                                },
                                {
                                    "label": "OHS Server 12.2.1.4.0 and JDK8 on Oracle Linux 7.6",
                                    "value": "wls-base-image-test1-preview;test-ohs-122140-jdk8-ol76;latest"
                                }
                            ]
                         },
                         "visible": "[steps('section_ohs').enableOHS]"                    
                    },
                    {
                        "name": "ohsDomainName",
                        "type": "Microsoft.Common.TextBox",
                        "label": "Oracle HTTP Server Domain name",
                        "defaultValue": "ohsStandaloneDomain",
                        "toolTip": "Oracle HTTP Server Domain Name",
                        "constraints": {
                            "required": true,
                            "regex": "^[a-z0-9A-Z.\\-_()]{0,89}([a-z0-9A-Z\\-_()]{1}){1,2}$",
                            "validationMessage": "[if(greater(length(steps('section_ohs').ohsDomainName), 90),'Must be less than 90 characters.', 'Value only allows alphanumeric characters, periods, underscores, hyphens and parenthesis and cannot end in a period.')]"
                        },
                        "visible": "[steps('section_ohs').enableOHS]"
                    },
                    {
                        "name": "ohsComponentName",
                        "type": "Microsoft.Common.TextBox",
                        "label": "Oracle HTTP Server Component name",
                        "defaultValue": "ohs_component",
                        "toolTip": "Oracle HTTP Server Component name",
                        "constraints": {
                            "required": true,
                            "regex": "^[a-z0-9A-Z.\\-_()]{0,89}([a-z0-9A-Z\\-_()]{1}){1,2}$",
                            "validationMessage": "[if(greater(length(steps('section_ohs').ohsDomainName), 90),'Must be less than 90 characters.', 'Value only allows alphanumeric characters, periods, underscores, hyphens and parenthesis and cannot end in a period.')]"
                        },
                        "visible": "[steps('section_ohs').enableOHS]"
                    },
                    {
                        "name": "ohsNMUser",
                        "type": "Microsoft.Common.TextBox",
                        "label": "Oracle HTTP Server NodeManager username",
                        "defaultValue": "",
                        "toolTip": "Oracle HTTP Server NodeManager username",
                        "constraints": {
                            "required": true,
                            "regex": "^[a-z0-9A-Z.\\-_()]{0,89}([a-z0-9A-Z\\-_()]{1}){1,2}$",
                            "validationMessage": "[if(greater(length(steps('section_ohs').ohsDomainName), 90),'Must be less than 90 characters.', 'Value only allows alphanumeric characters, periods, underscores, hyphens and parenthesis and cannot end in a period.')]"
                        },
                        "visible": "[steps('section_ohs').enableOHS]"
                    },
                    {
                        "name": "ohsNMPassword",
                        "type": "Microsoft.Common.PasswordBox",
                        "label": {
                            "password": "Oracle HTTP Server NodeManager Password",
                            "confirmPassword": "Confirm password"
                        },
                        "toolTip": "Oracle HTTP Server NodeManager password",
                        "constraints": {
                            "required": true,
                            "regex": "^(?=.*[A-Z])(?=.*[a-z])(?=.*\\d)[A-Za-z\\d]{12,}$",
                            "validationMessage": "The password must contain at least 12 characters, with at least 1 uppercase letter, 1 lowercase letter and 1 number, and special characters are not allowed."
                        },
                        "options": {
                            "hideConfirmation": false
                        },
                        "visible": "[steps('section_ohs').enableOHS]"
                    },
                    {
                        "name": "ohshttpPort",
                        "type": "Microsoft.Common.TextBox",
                        "label": "Oracle HTTP Server HTTP Port",
                        "defaultValue": "7777",
                        "toolTip": "Oracle HTTP Server HTTP Port",
                        "constraints": {
                            "required": true,
                            "regex": "^[0-9]{2,5}$",
                            "validationMessage": "[if(greater(length(steps('section_ohs').ohshttpPort), 90),'Resource group names only allow up to 90 characters.', 'Resource group names only allow alphanumeric characters, periods, underscores, hyphens and parenthesis and cannot end in a period.')]"
                        },
                        "visible": "[steps('section_ohs').enableOHS]"
                    },
                    {
                        "name": "ohshttpsPort",
                        "type": "Microsoft.Common.TextBox",
                        "label": "Oracle HTTP Server HTTPS Port",
                        "defaultValue": "4444",
                        "toolTip": "Oracle HTTP Server HTTPS Port",
                        "constraints": {
                            "required": true,
                            "regex": "^[0-9]{2,5}$",
                            "validationMessage": "[if(greater(length(steps('section_ohs').ohshttpsPort), 90),'Resource group names only allow up to 90 characters.', 'Resource group names only allow alphanumeric characters, periods, underscores, hyphens and parenthesis and cannot end in a period.')]"
                        },
                        "visible": "[steps('section_ohs').enableOHS]"
                    },
                    {
                        "name": "oracleVaultPswd",
                        "type": "Microsoft.Common.PasswordBox",
                        "label": {
                            "password": "Oracle Vault Password",
                            "confirmPassword": "Confirm password"
                        },
                        "toolTip": "Oracle Vault password",
                        "constraints": {
                            "required": true,
                            "regex": "^(?=.*[A-Z])(?=.*[a-z])(?=.*\\d)[A-Za-z\\d]{12,}$",
                            "validationMessage": "The password must contain at least 12 characters, with at least 1 uppercase letter, 1 lowercase letter and 1 number, and special characters are not allowed."
                        },
                        "options": {
                            "hideConfirmation": false
                        },
                        "visible": "[steps('section_ohs').enableOHS]"
                    },
                    {
                        "name": "keyType",
                        "type": "Microsoft.Common.DropDown",
                        "label": "Certificate Type",
                        "defaultValue": "PKCS12",
                        "toolTip": "Type of the certificate format",
                        "constraints": {
                            "allowedValues": [
                               {
                                   "label": "PKCS12",
                                   "value": "PKCS12"
                               },
                               {
                                   "label": "JKS",
                                   "value": "JKS"
                               }
                            ],
                            "required": false
                        },
                        "visible": "[steps('section_ohs').enableOHS]"
                    },
                    {
                        "name": "keyVaultResourceGroup",
                        "type": "Microsoft.Common.TextBox",
                        "label": "Resource group name in current subscription containing the KeyVault",
                        "defaultValue": "",
                        "toolTip": "Use only letters and numbers",
                        "constraints": {
                            "required": true,
                            "regex": "^[a-z0-9A-Z.\\-_()]{0,89}([a-z0-9A-Z\\-_()]{1}){1,2}$",
                            "validationMessage": "[if(greater(length(steps('section_ohs').ohsDomainName), 90),'Must be less than 90 characters.', 'Value only allows alphanumeric characters, periods, underscores, hyphens and parenthesis and cannot end in a period.')]"
                        },
                        "visible": "[steps('section_ohs').enableOHS]"
                    },
                    {
                        "name": "keyVaultName",
                        "type": "Microsoft.Common.TextBox",
                        "label": "Name of the Azure KeyVault containing secrets for the Certificate for SSL Termination",
                        "defaultValue": "",
                        "toolTip": "Use only letters and numbers",
                        "constraints": {
                            "required": true,
                            "regex": "^(?=.{3,24}$)[a-zA-Z](([a-z0-9A-Z]*|(?:\\-[^\\-][a-z0-9A-Z]*))*)$",
                            "validationMessage": "[if(or(greater(length(steps('section_ohs').keyVaultName), 24), less(length(steps('section_ohs').keyVaultName), 3)),'Vault name must be between 3-24 alphanumeric characters. The name must begin with a letter, end with a letter or digit, and not contain consecutive hyphens.','Vault name must only contain alphanumeric characters and dashes and cannot start with a number')]"
                        },
                        "visible": "[steps('section_ohs').enableOHS]"
                    },
                    {
                        "name": "keyVaultSSLCertDataSecretName",
                        "type": "Microsoft.Common.TextBox",
                        "label": "The name of the secret in the specified KeyVault whose value is the SSL Certificate Data",
                        "defaultValue": "",
                        "toolTip": "Use only letters and numbers",
                        "constraints": {
                            "required": true,
                            "regex": "^[a-z0-9A-Z]{1,30}$",
                            "validationMessage": "The value must be 1-30 characters long and must only contain letters and numbers."
                        },
                        "visible": "[steps('section_ohs').enableOHS]"
                    },
                    {
                        "name": "keyVaultSSLCertPasswordSecretName",
                        "type": "Microsoft.Common.TextBox",
                        "label": "The name of the secret in the specified KeyVault whose value is the password for the SSL Certificate",
                        "defaultValue": "",
                        "toolTip": "Use only letters and numbers",
                        "constraints": {
                            "required": true,
                            "regex": "^[a-z0-9A-Z]{1,30}$",
                            "validationMessage": "The value must be 1-30 characters long and must only contain letters and numbers."
                        },
                        "visible": "[steps('section_ohs').enableOHS]"
                    }
                ],
                "visible": true
            },		        
            {
                "name": "section_database",
                "type": "Microsoft.Common.Section",
                "label": "Database",
                "subLabel": {
                    "preValidation": "Configure integrations to Azure services",
                    "postValidation": "Done"
                },
                "bladeTitle": "Service Integrations",
                "elements": [
                    {
                        "name": "aboutDatabase",
                        "type": "Microsoft.Common.TextBlock",
                        "visible": true,
                        "options": {
                            "text": "Selecting 'Yes' here and providing the configuration will cause the template to configure the WebLogic Server to connect to the desired pre-existing Database.  The database must be network accessible to the VNET and subnets created by the template."
                        }
                    },
                    {
                        "name": "enableDB",
                        "type": "Microsoft.Common.OptionsGroup",
                        "label": "Connect to Database?",
                        "defaultValue": "No",
                        "toolTip": "Select 'Yes' and provide required info to configure the connection to a database.",
                        "constraints": {
                            "allowedValues": [
                                {
                                    "label": "Yes",
                                    "value": "true"
                                },
                                {
                                    "label": "No",
                                    "value": "false"
                                }
                            ],
                            "required": true
                        }
                    },
                    {
                        "name": "databaseConnectionInfo",
                        "type": "Microsoft.Common.Section",
                        "label": "Connection settings",
                        "elements": [
                            {
                                "name": "databaseType",
                                "type": "Microsoft.Common.DropDown",
                                "label": "Choose database type",
                                "toolTip": "Choose database type",
                                "defaultValue": "Oracle Database",
                                "constraints": {
                                    "allowedValues": [
                                        {
                                            "label": "Azure Database for PostgreSQL",
                                            "value": "postgresql"
                                        },
                                        {
                                            "label": "Oracle Database",
                                            "value": "oracle"
                                        },
                                        {
                                            "label": "Azure SQL",
                                            "value": "sqlserver"
                                        }
                                    ],
                                    "required": true
                                },
                                "visible": true
                            },
                            {
                                "name": "jdbcDataSourceName",
                                "type": "Microsoft.Common.TextBox",
                                "label": "JNDI Name",
                                "toolTip": "The JNDI name for the database JDBC connection",
                                "defaultValue": "",
                                "constraints": {
                                    "required": "[bool(steps('section_database').enableDB)]",
                                    "regex": "^[a-z0-9A-Z/]{1,30}$",
                                    "validationMessage": "The value must be 1-30 characters long and must only contain letters and numbers."
                                },
                                "visible": true
                            },
                            {
                                "name": "dsConnectionURL",
                                "type": "Microsoft.Common.TextBox",
                                "label": "DataSource Connection String",
                                "toolTip": "The JDBC connection string for the database",
                                "defaultValue": "",
                                "constraints": {
                                    "required": "[bool(steps('section_database').enableDB)]",
                                    "regex": "[concat('^jdbc:', coalesce(steps('section_database').databaseConnectionInfo.databaseType, ''), '.*$')]",
                                    "validationMessage": "A valid JDBC URL for the chosen database type must be provided"
                                },
                                "visible": true
                            },
                            {
                                "name": "dbUser",
                                "type": "Microsoft.Common.TextBox",
                                "label": "Database Username",
                                "toolTip": "Use only letters and numbers",
                                "defaultValue": "",
                                "constraints": {
                                    "required": "[bool(steps('section_database').enableDB)]",
                                    "regex": "^(?=.{1,128}$)(?!\\-)([a-z0-9A-Z@\\-]){1,128}([^\\-])$",
                                    "validationMessage": "The value must be 1-128 characters long and must only contain letters, numbers, hyphen(-) and the at sign, no hyphen allowed at the beginning and the end of Database Username."
                                },
                                "visible": true
                            },
                            {
                                "name": "dbPassword",
                                "type": "Microsoft.Common.PasswordBox",
                                "label": {
                                    "password": "Database Password",
                                    "confirmPassword": "Confirm password"
                                },
                                "toolTip": "Database Password",
                                "constraints": {
                                    "required": "[bool(steps('section_database').enableDB)]",
                                    "regex": "^((?=.*[0-9])(?=.*[a-z])|(?=.*[0-9])(?=.*[a-z])(?=.*[A-Z])|(?=.*[0-9])(?=.*[a-z])(?=.*[!@#$%^&*])|(?=.*[0-9])(?=.*[A-Z])(?=.*[!@#$%^&*])|(?=.*[a-z])(?=.*[A-Z])(?=.*[!@#$%^&*])).{6,128}$",
                                    "validationMessage": "The password must contain at least 6 characters, with at least 1 uppercase letter, 1 lowercase letter and 1 number."
                                },
                                "options": {
                                    "hideConfirmation": false
                                },
                                "visible": true
                            }
                        ],
                        "visible": "[bool(steps('section_database').enableDB)]"
                    }
                ]
            },
            {
                "name": "section_aad",
                "label": "Azure Active Directory",
                "subLabel": {
                    "preValidation": "Configure the connection to Azure Active Directory.",
                    "postValidation": "Done"
                },
                "bladeTitle": "Azure Active Directory",
                "elements": [
                    {
                        "name": "aboutAad",
                        "type": "Microsoft.Common.TextBlock",
                        "visible": true,
                        "options": {
                            "icon": "None",
                            "text": "Selecting 'Yes' here and providing the configuration will cause the template to configure the connection to Azure Active Directory.",
                            "link": {
                                "label": "Learn more",
                                "uri": "https://aka.ms/arm-oraclelinux-wls-cluster-aad-ldap"
                            }
                        }
                    },
                    {
                        "name": "enableAAD",
                        "type": "Microsoft.Common.OptionsGroup",
                        "label": "Connect to Azure Active Directory?",
                        "defaultValue": "No",
                        "toolTip": "Select 'Yes' and provide required info to configure the connection to Azure Active Directory.",
                        "constraints": {
                            "allowedValues": [
                                {
                                    "label": "Yes",
                                    "value": "true"
                                },
                                {
                                    "label": "No",
                                    "value": "false"
                                }
                            ],
                            "required": true
                        }
                    },
                    {
                        "name": "aadInfo",
                        "type": "Microsoft.Common.Section",
                        "label": "Connection settings",
                        "elements": [
                            {
                                "name": "aadsServerHost",
                                "type": "Microsoft.Common.TextBox",
                                "label": "Server Host",
                                "toolTip": "The LDAP server host.",
                                "defaultValue": "",
                                "constraints": {
                                    "required": true,
                                    "regex": "(?:[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?\\.)+[a-z0-9][a-z0-9-]{0,61}[a-z0-9]",
                                    "validationMessage": "The value must be a valid host name."
                                }
                            },
                            {
                                "name": "aadsPublicIP",
                                "type": "Microsoft.Common.TextBox",
                                "label": "Secure LDAP external IP address",
                                "toolTip": "Secure LDAP external IP address.",
                                "constraints": {
                                    "required": true,
                                    "regex": "\\b((25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)(\\.|$)){4}\\b",
                                    "validationMessage": "The value must be a valid IP address."
                                }
                            },
                            {
                                "name": "aadsPortNumber",
                                "type": "Microsoft.Common.TextBox",
                                "label": "Port",
                                "toolTip": "The port number of LDAP Server, default is 636.",
                                "defaultValue": "636",
                                "constraints": {
                                    "required": true,
                                    "regex": "^[0-9]+$",
                                    "validationMessage": "The value must be numbers."
                                }
                            },
                            {
                                "name": "wlsLDAPProviderName",
                                "type": "Microsoft.Common.TextBox",
                                "label": "Provider Name",
                                "defaultValue": "AzureActiveDirectoryProvider",
                                "toolTip": "The value used for creating authentication provider name of WebLogic Server.",
                                "constraints": {
                                    "required": true,
                                    "regex": "^[a-z0-9A-Z]{3,50}$",
                                    "validationMessage": "The Provider Name must be between 3 and 50 characters long and contain letters, numbers only."
                                }
                            },
                            {
                                "name": "wlsLDAPPrincipal",
                                "type": "Microsoft.Common.TextBox",
                                "label": "Principal",
                                "toolTip": "The Distinguished Name (DN) of the LDAP user that WebLogic Server should use to connect to the LDAP server.",
                                "constraints": {
                                    "required": true,
                                    "regex": ".+,dc|DC=([^,]+),dc|DC=([^,]+)$",
                                    "validationMessage": "The value must be valid LDAP user distinguished name."
                                }
                            },
                            {
                                "name": "wlsLDAPPrincipalPassword",
                                "type": "Microsoft.Common.PasswordBox",
                                "label": {
                                    "password": "Password for Principal",
                                    "confirmPassword": "Confirm password"
                                },
                                "toolTip": "The credential (usually a password) used to connect to the LDAP server.",
                                "constraints": {
                                    "required": true
                                }
                            },
                            {
                                "name": "wlsLDAPUserBaseDN",
                                "type": "Microsoft.Common.TextBox",
                                "label": "User Base DN",
                                "toolTip": "The base distinguished name (DN) of the tree in the LDAP directory that contains users.",
                                "constraints": {
                                    "required": true,
                                    "regex": ".+,dc|DC=([^,]+),dc|DC=([^,]+)$",
                                    "validationMessage": "The value must be valid LDAP user based distinguished name."
                                }
                            },
                            {
                                "name": "wlsLDAPGroupBaseDN",
                                "type": "Microsoft.Common.TextBox",
                                "label": "Group Base DN",
                                "toolTip": "The base distinguished name (DN) of the tree in the LDAP directory that contains groups.",
                                "constraints": {
                                    "required": true,
                                    "regex": ".+,dc|DC=([^,]+),dc|DC=([^,]+)$",
                                    "validationMessage": "The value must be valid LDAP group based distinguished name."
                                }
                            },
                            {
                                "name": "wlsLDAPSSLCertificate",
                                "type": "Microsoft.Common.FileUpload",
                                "label": "Trust Keystore for SSL Configuration",
                                "toolTip": "Custom Trust Keystore of WebLogic Server, used to enable SSL.",
                                "constraints": {
                                    "required": true,
                                    "accept": ".cer"
                                },
                                "options": {
                                    "multiple": false,
                                    "uploadMode": "file",
                                    "openMode": "binary"
                                }
                            }
                        ],
                        "visible": "[bool(steps('section_aad').enableAAD)]"
                    }
                ]
            },
            {
                "name": "section_elk",
                "label": "Elasticsearch and Kibana",
                "subLabel": {
                    "preValidation": "Configure the connection to Elasticsearch and Kibana.",
                    "postValidation": "Done"
                },
                "bladeTitle": "Elasticsearch and Kibana",
                "elements": [
                    {
                        "name": "aboutelk",
                        "type": "Microsoft.Common.TextBlock",
                        "visible": true,
                        "options": {
                            "icon": "None",
                            "text": "Selecting 'Yes' here and providing the configuration will cause the template to configure the Elasticsearch and Kibana, the WebLogic Server logs will be exported to Elasticsearch. To ensure Logstash works correctly, the selected Virtual Machines have at least 2.5GB memory.",
                            "link": {
                                "label": "Learn more",
                                "uri": "https://aka.ms/arm-oraclelinux-wls-elk"
                            }
                        }
                    },
                    {
                        "name": "enableELK",
                        "type": "Microsoft.Common.OptionsGroup",
                        "label": "Export logs to Elasticsearch?",
                        "defaultValue": "No",
                        "toolTip": "Select 'Yes' and provide required info to configure the connection to Elasticsearch.",
                        "constraints": {
                            "allowedValues": [
                                {
                                    "label": "Yes",
                                    "value": "true"
                                },
                                {
                                    "label": "No",
                                    "value": "false"
                                }
                            ],
                            "required": true
                        }
                    },
                    {
                        "name": "elkInfo",
                        "type": "Microsoft.Common.Section",
                        "label": "Connection settings",
                        "elements": [
                            {
                                "name": "elkMemoryRequired",
                                "type": "Microsoft.Common.InfoBox",
                                "options": {
                                    "icon": "Error",
                                    "text": "Your selected Virtual Machines have less than 2.5GB memory to set up Elasticsearch and Kibana, please go to Basics -> Virtual machine size to change it, recommended size is Standard_A2_v2."
                                },
                                "visible": "[and(contains('Standard_A1,Basic_A1,Standard_B1ms,Standard_A1_v2,Standard_F1,Standard_F1s', basics('vmSizeSelect')),bool(steps('section_elk').enableELK))]"
                            },
                            {
                                "name": "elasticsearchEndpoint",
                                "type": "Microsoft.Common.TextBox",
                                "label": "Elasticsearch endpoint URL",
                                "toolTip": "Elasticsearch endpoint.",
                                "defaultValue": "https://example.location.azure.elastic-cloud.com:9243",
                                "constraints": {
                                    "required": true,
                                    "validations": [
                                        {
                                            "regex": "^https?:\\/\\/(www\\.)?[-a-zA-Z0-9@:%._\\+~#=]{1,256}\\.[a-zA-Z0-9()]{1,6}\\b([-a-zA-Z0-9()@:%_\\+.~#?&//=]*):[0-9]{1,6}$",
                                            "message": "The value must be a valid endpoint."
                                        },
                                        {
                                            "isValid": "[not(contains('Standard_A1,Basic_A1,Standard_B1ms,Standard_A1_v2,Standard_F1,Standard_F1s', basics('vmSizeSelect')))]",
                                            "message": "Your selected Virtual Machines have less than 2.5GB memory to set up Elasticsearch and Kibana, please go to Basics -> Virtual machine size to change it, recommended size is Standard_A2_v2."
                                        }
                                    ]
                                }
                            },
                            {
                                "name": "elasticsearchUserName",
                                "type": "Microsoft.Common.TextBox",
                                "label": "Elasticsearch User Name",
                                "defaultValue": "elastic",
                                "toolTip": "User name of Elasticsearch account.",
                                "constraints": {
                                    "required": true,
                                    "regex": "^(?!\\-)([a-z0-9A-Z@\\-]{1,128})([^\\-])",
                                    "validationMessage": "The value must be valid Elasticsearch user name."
                                }
                            },
                            {
                                "name": "elasticsearchPassword",
                                "type": "Microsoft.Common.PasswordBox",
                                "label": {
                                    "password": "Password for Elasticsearch account",
                                    "confirmPassword": "Confirm password"
                                },
                                "toolTip": "Password of Elasticsearch account.",
                                "constraints": {
                                    "required": true
                                }
                            },
                            {
                                "name": "logsToIntegrate",
                                "type": "Microsoft.Common.DropDown",
                                "label": "WebLogic Server logs to export",
                                "toolTip": "The logs selected will be exported to Elasticsearch.",
                                "defaultValue": [
                                    "Server Log"
                                ],
                                "multiselect": true,
                                "selectAll": true,
                                "multiLine": true,
                                "defaultDescription": "The logs selected will be exported to Elasticsearch",
                                "constraints": {
                                    "allowedValues": [
                                        {
                                            "label": "Data Source Log",
                                            "description": "Export Datasource logs to Elasticsearch.",
                                            "value": "DataSourceLog"
                                        },
                                        {
                                            "label": "Domain Log",
                                            "description": "Export Domain logs to Elasticsearch.",
                                            "value": "DomainLog"
                                        },
                                        {
                                            "label": "HTTP Access Log",
                                            "description": "Export HTTP logs to Elasticsearch.",
                                            "value": "HTTPAccessLog"
                                        },
                                        {
                                            "label": "Node Manager Logs",
                                            "description": "Export Node Manager logs to Elasticsearch.",
                                            "value": "NodeManagerLog"
                                        },
                                        {
                                            "label": "Server Log",
                                            "description": "Export Server logs to Elasticsearch.",
                                            "value": "ServerLog"
                                        },
                                        {
                                            "label": "Standard error and output",
                                            "description": "Export standard error and output to Elasticsearch.",
                                            "value": "StandardErrorAndOutput"
                                        }
                                    ],
                                    "required": true
                                }
                            }
                        ],
                        "visible": "[bool(steps('section_elk').enableELK)]"
                    }
                ]
            },
            {
                "name": "section_coherence",
                "label": "Coherence",
                "subLabel": {
                    "preValidation": "Configure Coherence.",
                    "postValidation": "Done"
                },
                "bladeTitle": "Coherence",
                "elements": [
                    {
                        "name": "aboutCoherence",
                        "type": "Microsoft.Common.TextBlock",
                        "visible": true,
                        "options": {
                            "icon": "None",
                            "text": "Selecting 'Yes' here and providing the configuration will cause the template to create a Coherence cluster, the WebLogic Domain will create a data tier configured with Managed Coherence cache servers.",
                            "link": {
                                "label": "Learn more",
                                "uri": "https://aka.ms/arm-oraclelinux-wls-coherence"
                            }
                        }
                    },
                    {
                        "name": "enableCoherence",
                        "type": "Microsoft.Common.OptionsGroup",
                        "label": "Use Coherence cache?",
                        "defaultValue": "No",
                        "toolTip": "Select 'Yes' and provide required info to configure Coherence cluster.",
                        "constraints": {
                            "allowedValues": [
                                {
                                    "label": "Yes",
                                    "value": "true"
                                },
                                {
                                    "label": "No",
                                    "value": "false"
                                }
                            ],
                            "required": true
                        }
                    },
                    {
                        "name": "coherenceInfo",
                        "type": "Microsoft.Common.Section",
                        "label": "Coherence settings",
                        "elements": [
                            {
                                "name": "coherenceVMSizeSelect",
                                "type": "Microsoft.Compute.SizeSelector",
                                "label": "Coherence virtual machine size",
                                "toolTip": "The size of virtual machine for Coherence cache servers.",
                                "recommendedSizes": [
                                    "[basics('vmSizeSelect')]"
                                ],
                                "constraints": {
                                    "excludedSizes": [
                                        "Standard_B1ls",
                                        "Standard_A0",
                                        "Basic_A0",
                                        "Standard_B1s"
                                    ]
                                },
                                "osPlatform": "Linux",
                                "count": "1",
                                "visible": true
                            },
                            {
                                "name": "numberOfCoherenceStorageInstances",
                                "type": "Microsoft.Common.TextBox",
                                "label": "Number of Coherence cache servers",
                                "toolTip": "Number of Coherence cache instances, used to create virtual machines and WebLogic Managed Server.",
                                "defaultValue": "1",
                                "constraints": {
                                    "required": true,
                                    "regex": "^[0-9]+$",
                                    "validationMessage": "The value must be a valid number."
                                }
                            },
                            {
                                "name": "enableCoherenceWebLocalStorage",
                                "type": "Microsoft.Common.OptionsGroup",
                                "label": "Coherence Web Local Storage Enabled",
                                "defaultValue": "Yes",
                                "toolTip": "Specifies whether Local Storage is enabled for the Coherence*Web cluster tier",
                                "constraints": {
                                    "allowedValues": [
                                        {
                                            "label": "Yes",
                                            "value": "true"
                                        },
                                        {
                                            "label": "No",
                                            "value": "false"
                                        }
                                    ],
                                    "required": true
                                }
                            }
                        ],
                        "visible": "[bool(steps('section_coherence').enableCoherence)]"
                    }
                ]
            }
        ],
        "outputs": {
            "Location": "[location()]",
            "aadsPortNumber": "[steps('section_aad').aadInfo.aadsPortNumber]",
            "aadsPublicIP": "[steps('section_aad').aadInfo.aadsPublicIP]",
            "aadsServerHost": "[steps('section_aad').aadInfo.aadsServerHost]",
            "adminPasswordOrKey": "[if(equals(basics('basicsRequired').adminPasswordOrKey.authenticationType, 'password'), basics('basicsRequired').adminPasswordOrKey.password, basics('basicsRequired').adminPasswordOrKey.sshPublicKey)]",
            "adminUsername": "[basics('basicsRequired').adminUsername]",
            "authenticationType": "[basics('basicsRequired').adminPasswordOrKey.authenticationType]",
            "enableDB": "[bool(steps('section_database').enableDB)]",
            "databaseType": "[steps('section_database').databaseConnectionInfo.databaseType]",
            "dnsLabelPrefix": "[basics('basicsOptional').dnsLabelPrefix]",
            "dsConnectionURL": "[steps('section_database').databaseConnectionInfo.dsConnectionURL]",
            "dbPassword": "[steps('section_database').databaseConnectionInfo.dbPassword]",
            "dbUser": "[steps('section_database').databaseConnectionInfo.dbUser]",
            "elasticsearchEndpoint": "[steps('section_elk').elkInfo.elasticsearchEndpoint]",
            "elasticsearchPassword": "[steps('section_elk').elkInfo.elasticsearchPassword]",
            "elasticsearchUserName": "[steps('section_elk').elkInfo.elasticsearchUserName]",
            "dynamicClusterSize": "[int(basics('basicsRequired').dynamicClusterSize)]",
            "enableAAD": "[bool(steps('section_aad').enableAAD)]",
            "enableCoherence": "[bool(steps('section_coherence').enableCoherence)]",
            "enableCoherenceWebLocalStorage": "[bool(if(bool(steps('section_coherence').enableCoherence),steps('section_coherence').coherenceInfo.enableCoherenceWebLocalStorage,'false'))]",
            "enableELK": "[bool(steps('section_elk').enableELK)]",
            "jdbcDataSourceName": "[steps('section_database').databaseConnectionInfo.jdbcDataSourceName]",
            "logsToIntegrate": "[steps('section_elk').elkInfo.logsToIntegrate]",
            "managedServerPrefix": "[basics('basicsOptional').managedServerPrefix]",
            "maxDynamicClusterSize": "[int(basics('basicsRequired').maxDynamicClusterSize)]",
            "numberOfCoherenceCacheInstances": "[int(if(bool(steps('section_coherence').enableCoherence),steps('section_coherence').coherenceInfo.numberOfCoherenceStorageInstances,'1'))]",
            "portsToExpose": "[basics('basicsOptional').portsToExpose]",
            "skuUrnVersion": "[basics('skuUrnVersion')]",
            "useSystemAssignedManagedIdentity": "[basics('basicsOptional').useSystemAssignedManagedIdentity]",
            "vmSizeSelect": "[basics('vmSizeSelect')]",
            "vmSizeSelectForCoherence": "[steps('section_coherence').coherenceInfo.coherenceVMSizeSelect]",
            "wlsDomainName": "[basics('basicsOptional').wlsDomainName]",
            "wlsLDAPGroupBaseDN": "[steps('section_aad').aadInfo.wlsLDAPGroupBaseDN]",
            "wlsLDAPPrincipal": "[steps('section_aad').aadInfo.wlsLDAPPrincipal]",
            "wlsLDAPPrincipalPassword": "[steps('section_aad').aadInfo.wlsLDAPPrincipalPassword]",
            "wlsLDAPProviderName": "[steps('section_aad').aadInfo.wlsLDAPProviderName]",
            "wlsLDAPSSLCertificate": "[steps('section_aad').aadInfo.wlsLDAPSSLCertificate]",
            "wlsLDAPUserBaseDN": "[steps('section_aad').aadInfo.wlsLDAPUserBaseDN]",
            "wlsPassword": "[basics('basicsRequired').wlsPassword]",
            "wlsUserName": "[basics('basicsRequired').wlsUserName]",
            "enableOHS": "[bool(steps('section_ohs').enableOHS)]",
            "ohsSkuUrnVersion": "[steps('section_ohs').ohsSkuUrnVersion]",
            "ohsDomainName": "[steps('section_ohs').ohsDomainName]",
            "ohsComponentName": "[steps('section_ohs').ohsComponentName]",
            "ohsNMUser": "[steps('section_ohs').ohsNMUser]",
            "ohsNMPassword": "[steps('section_ohs').ohsNMPassword]",
            "ohshttpPort": "[steps('section_ohs').ohshttpPort]",
            "ohshttpsPort": "[steps('section_ohs').ohshttpsPort]",
            "oracleVaultPswd": "[steps('section_ohs').oracleVaultPswd]",
            "keyType": "[steps('section_ohs').keyType]",
            "keyVaultResourceGroup": "[steps('section_ohs').keyVaultResourceGroup]",
            "keyVaultName": "[steps('section_ohs').keyVaultName]",
            "keyVaultSSLCertDataSecretName": "[steps('section_ohs').keyVaultSSLCertDataSecretName]",
            "keyVaultSSLCertPasswordSecretName": "[steps('section_ohs').keyVaultSSLCertPasswordSecretName]"
        }
    }
}
